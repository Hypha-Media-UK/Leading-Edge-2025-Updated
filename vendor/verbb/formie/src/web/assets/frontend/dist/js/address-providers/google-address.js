!function(){"use strict";var t={8624:function(t,e,o){o.d(e,{E:function(){return s}});var i=o(4685);class s{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$form=t.$form,this.form=this.$form.form,this.$field=t.$field,this.$locationBtn=this.$field.querySelector("[data-fui-address-location-btn]"),this.loadingClass=this.form.getClasses("loading"),this.initLocationBtn()}initLocationBtn(){this.$locationBtn&&this.form.addEventListener(this.$locationBtn,(0,i.kK)("click"),(t=>{t.preventDefault(),this.onStartFetchLocation(),navigator.geolocation?navigator.geolocation.getCurrentPosition((t=>{this.onCurrentLocation(t)}),(t=>{console.log(`Unable to fetch location ${t.code}.`),this.onEndFetchLocation()}),{enableHighAccuracy:!0}):(console.log("Browser does not support geolocation."),this.onEndFetchLocation())}))}onCurrentLocation(t){this.onEndFetchLocation()}onStartFetchLocation(){(0,i.PT)(this.$locationBtn,this.loadingClass),this.$locationBtn.setAttribute("aria-disabled",!0)}onEndFetchLocation(){(0,i.GK)(this.$locationBtn,this.loadingClass),this.$locationBtn.setAttribute("aria-disabled",!1)}}window.FormieAddressProvider=s},4685:function(t,e,o){o.d(e,{GK:function(){return n},PT:function(){return s},kK:function(){return i},yR:function(){return r}});const i=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e||(e=Math.random().toString(36).substr(2,5)),`${t}.${e}`},s=function(t,e){t&&e&&("string"==typeof e&&(e=e.split(" ")),e.forEach((e=>{t.classList.add(e)})))},n=function(t,e){t&&e&&("string"==typeof e&&(e=e.split(" ")),e.forEach((e=>{t.classList.remove(e)})))},r=function(t,e,o,i,s,n){const r=new XMLHttpRequest;r.open(e,o,i,s,n),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.setRequestHeader("Accept","application/json"),r.setRequestHeader("Cache-Control","no-cache");const a=new CustomEvent("modifyAjaxClient",{bubbles:!0,detail:{client:r}});return t.dispatchEvent(a),a.detail.client}}},e={};function o(i){var s=e[i];if(void 0!==s)return s.exports;var n=e[i]={exports:{}};return t[i](n,n.exports,o),n.exports}o.d=function(t,e){for(var i in e)o.o(e,i)&&!o.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){var t=o(4685),e=o(8624);function i(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,i)}return o}function s(t,e,o){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class n extends e.E{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(t),this.$form=t.$form,this.form=this.$form.form,this.$field=t.$field,this.$input=this.$field.querySelector("[data-autocomplete]"),this.scriptId="FORMIE_GOOGLE_ADDRESS_SCRIPT",this.appId=t.appId,this.apiKey=t.apiKey,this.geocodingApiKey=t.geocodingApiKey||t.apiKey,this.options=t.options,this.retryTimes=0,this.maxRetryTimes=150,this.waitTimeout=200,this.$input?this.initScript():console.error("Unable to find input `[data-autocomplete]`.")}initScript(){if(document.getElementById(this.scriptId))this.waitForLoad();else{const t=document.createElement("script");t.src=`https://maps.googleapis.com/maps/api/js?key=${this.apiKey}&loading=async&libraries=places`,t.defer=!0,t.async=!0,t.id=this.scriptId,t.onload=()=>{this.waitForLoad()},document.body.appendChild(t)}}waitForLoad(){this.retryTimes>this.maxRetryTimes?console.error(`Unable to load Google API after ${this.retryTimes} times.`):"undefined"==typeof google||void 0===google.maps||void 0===google.maps.places?(this.retryTimes+=1,setTimeout(this.waitForLoad.bind(this),this.waitTimeout)):this.initAutocomplete()}initAutocomplete(){const t=function(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?i(Object(o),!0).forEach((function(e){s(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):i(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}({types:["geocode"]},this.options),e=new google.maps.places.PlaceAutocompleteElement(t);e.style.height=window.getComputedStyle(this.$input).height,e.style.boxSizing="border-box";let o=this.$input.parentElement;o&&o.classList.contains("fui-autocomplete-wrapper")||(o=document.createElement("div"),o.classList.add("fui-autocomplete-wrapper"),this.$input.parentNode.insertBefore(o,this.$input),o.appendChild(this.$input)),o.replaceChild(e,this.$input);const n=this.$input;n.type="hidden",n.name=this.$input.name,o.appendChild(n),e.addEventListener("gmp-select",(async t=>{let{placePrediction:e}=t;const o=e.toPlace();if(await o.fetchFields({fields:["addressComponents"]}),!o.addressComponents)return;this.setAddressValues(o.addressComponents);const i=new CustomEvent("populateAddress",{bubbles:!0,detail:{addressProvider:this,addressComponents:o.addressComponents}});this.$field.dispatchEvent(i)}))}setAddressValues(t){const e={},o=this.componentMap();for(let i=0;i<t.length;i++){const[s]=t[i].types;o[s]&&(e[s]=t[i][o[s]])}if(e.street_number&&e.route){let t=`${e.street_number} ${e.route}`;e.subpremise&&(t=`${e.subpremise}/${t}`),this.setFieldValue("[data-address1]",t)}this.setFieldValue("[data-city]",e.locality,e.postal_town),this.setFieldValue("[data-zip]",e.postal_code),this.setFieldValue("[data-state]",e.administrative_area_level_1),this.setFieldValue("[data-country]",e.country)}onCurrentLocation(e){const{latitude:o,longitude:i}=e.coords,s=(0,t.yR)(this.$form,"POST",window.location.href,!0);s.timeout=1e4,s.ontimeout=()=>{console.log("The request timed out.")},s.onerror=t=>{console.log("The request encountered a network error. Please try again.")},s.onload=()=>{if(this.onEndFetchLocation(),s.status>=200&&s.status<300)try{const t=JSON.parse(s.responseText);t&&t.results&&t.results[0]&&t.results[0].address_components&&this.setAddressValues(t.results[0].address_components),(t.error_message||t.error)&&console.log(t)}catch(t){console.log(t)}else console.log(`${s.status}: ${s.statusText}`)};const n=new FormData;n.append("action","formie/address/google-places-geocode"),n.append("latlng",`${o},${i}`),n.append("key",this.geocodingApiKey),s.send(n)}componentMap(){return{subpremise:"shortText",street_number:"shortText",route:"longText",postal_town:"longText",locality:"longText",administrative_area_level_1:"shortText",country:"shortText",postal_code:"shortText"}}setFieldValue(t,e,o){this.$field.querySelector(t)&&(this.$field.querySelector(t).value=e||o||"")}}window.FormieGoogleAddress=n}()}();